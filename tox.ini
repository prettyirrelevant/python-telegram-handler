[tox]
envlist = py38,py39,py310,py311,coverage

[gh-actions]
python =
    3.8: py38
    3.9: py39
    3.10: py310
    3.11: py311

[testenv]
skip_install = True
usedevelop = True
deps=
    -rrequirements-dev.txt
commands=py.test tests --cov-fail-under 90 --color=auto --cov=telegram_handler --cov-report=term-missing

[testenv:report]
deps = coverage
skip_install = true
passenv = CI,GITHUB_ACTION_REPOSITORY,GITHUB_ACTIONS,GITHUB_ACTOR,GITHUB_WORKFLOW_REF,GITHUB_RUN_ID
commands =
    coverage combine
    coverage html
    coverage report --fail-under=90
